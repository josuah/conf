#!/bin/sh -eu
# some helper to dump/fill babeld information

case "${1:-help}" in
(reload)
	pkill -USR2 babeld
	tail -n 1 /var/log/babeld.log
	;;
(show)
	pkill -USR1 babeld
	tail -n 100 /var/log/babeld.log \
	 | awk '{ out = out $0 "\n" } /^$/ { out = "" } END { printf "%s", out }'
	;;
(log)
	tail -f /var/log/babeld.log
	;;
(*)
	echo>&2 "usage:	${0##*/} reload"
	echo>&2 "	${0##*/} log"
	echo>&2 "	${0##*/} show"
	exit 1
	;;
esac
