#!/bin/sh -eu

. "${0%/bin/*}/bin/lib"

case $command in
( install )
	for file in "$base/module/$module/etc/"*; do
		case $file in ( *"/*" | */template.* ) break ;; esac

		mkdir -p "$etc"
		cp -rf "$file" "$etc"
	done

	for template in "$base/module/$module/etc/template."*; do
		case $template in ( *"/template.*" ) break ;; esac

		(cd "$base/db"; "$base/bin/template" >$tmp) <$template
		mkdir -p "$(dirname "$etc/$conf")"
		mv "$tmp" "$etc/$conf"
	done
	;;
esac
