#!/bin/sh -eu

item=${1:?}

item=${item%/}
host=host/$(hostname -s)/modules

touch "$host"
grep -Fxq "$item" "$host" || exec echo>&2 "$item already deleted for $host"

case $item in
(role/*|module/*)
	grep -Fxv "$item" "$host" | sort -o "$host" -
	echo>&2 "deleted $item"
	;;
(*)
	echo "unknown configuration type"
	;;
esac
