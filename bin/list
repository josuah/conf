#!/bin/sh -e

list() {
	local level="${1:?}" node="${2:?}"
	shift 2

	printf "%-$((level * 2))s%s" "" "$node"
	printf " %s" "$@"
	printf "\\n"

	[ -f "$base/def/$node" ] || return 0

	while read node args; do
		list $((level + 1)) "$node" "$@" $args
	done <$base/def/$node
}

node=${1:-host/$(hostname -s)}
[ "$#" = 0 ] || shift 1
node=${node%/}
node=${node#def/}
base=$(cd "${0%/*}/.."; pwd)

list 0 "$node" "$@"
