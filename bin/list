#!/bin/sh -e

node=${1:-host/$(hostname -s)}
node=${node#def/}
base=$(cd "${0%/*}/.."; pwd)

list() {
	local level="${1:?}" node="${2:?}" args="$3"

	printf "%-$((level * 2))s%s %s\\n" "" "$node" "$args"
	[ -f "$base/def/$node" ] || return 0

	while read node args; do
		list $((level + 1)) "$node" "$args"
	done <$base/def/$node
}

list 0 "$node"
