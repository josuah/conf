#!/bin/sh -eu

command=${1:?}
service=${2:?}
shift 2

case $("$base/bin/os") in
(openbsd)
	case $command in
	(status)
		rcctl check "$service"
		;;
	(*)
		rcctl "$command" "$service"
		;;
	esac
	;;
(*bsd)
	case $command in
	(enable)
		path=/etc/rc.conf.d/$service
		echo "$service=YES" >$path
		;;
	(disable)
		rm -f "/etc/rc.conf.d/$service"
		;;
	(*)
		"/etc/rc.d/$service" "$command"
		;;
	esac
	;;
(alpine|gentoo)
	case $command in
	(enable)
		rc-update add "$service" default
		;;
	(disable)
		rc-update del "$service" default
		;;
	(*)
		rc-service "$service" "$command"
		;;
	esac
	;;
(void)
	case $command in
	(enable)
		ln -sf "/etc/runit/sv/$service" "/run/runit/service"
		;;
	(disable)
		rm -f "/run/runit/service/$service"
		;;
	(start)
		sv up "$service"
		;;
	(*)
		sv "$command" "$service"
		;;
	esac
	;;
(debian|redhat|arch|suse)
	case "$command" in
	(*)
		systemctl "$command" "$service"
		;;
	esac
	;;
(*)
	echo >&2 "error: unknown os"
	exit 1
	;;
esac
