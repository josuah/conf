# deployed on {{date}}

include "/etc/macros.conf"
IP=$PRE6::443:1

chroot "/var/www"
prefork 4
default type "text"/"plain; charset=utf-8"

types {
	include "/usr/share/misc/mime.types"
}

server match "*" {
	listen on $PRE6::80:1 port 80
	log syslog
	location "/.well-known/acme-challenge/*" {
		root "/acme"
		request strip 2
		directory no auto index
		pass
	}
	block return 301 "https://$HTTP_HOST$REQUEST_URI"
}

server "default" {
	log syslog
	listen on $IP port 80
	root "/htdocs/default"
}

%% for file in /etc/httpd/*.conf; do [ -f "$file" ] || continue
include "{{file}}"
%% done
