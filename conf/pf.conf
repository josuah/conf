include "/etc/macros.conf"

table <whitelist> file "/etc/pf/table/whitelist"
table <blacklist> file "/etc/pf/table/blacklist"

# base
block log all
block in quick from <blacklist>
pass in from <whitelist>
pass out quick

# nat64
pass in quick inet af-to inet6 from $LOOPBACK to $LOOPBACK/128
pass in quick inet6 to 64:ff9b::/96 af-to inet from (egress)

# relayd
anchor "relayd/*"
match in quick tagged RELAYD nat-to $LOOPBACK # come back to me

# protocols
pass in quick on wg proto ospf
pass in proto { icmp, icmp6, esp }
pass in proto tcp to port 22
pass in proto { tcp, udp } to port { domain, domain-s }
pass in proto tcp to port git
pass in proto tcp to port gopher
pass in proto tcp to port { http, https }
pass in proto udp to port 50000:59999 #wg

include "/etc/pf/local.conf"
